{% extends "base.html" %}

{% block additional_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/forum.css') }}">
{% endblock %}

{% block content %}
    <div class="thread">
        <div class="thread-header">
            <h1 class="thread-title">{{ thread.title }}</h1>
            <div class="thread-user">
                {% if thread.user.badge %}
                <span class="user-badge" style="background-color:{{ thread.user.color }}">{{ thread.user.badge }}</span>
                {% endif %}
                <span class="user-name" style="color:{{ thread.user.color }}">{{ thread.user.nickname or thread.user.username }}</span>
                <span class="thread-meta">{{ thread.timestamp.strftime('%Y-%m-%d %H:%M') }}</span>
            </div>
        </div>
        <div class="thread-content" data-content="{{ thread.content|safe }}">
            <!-- 内容将由JS渲染 -->
        </div>
    </div>
    
    <div class="replies">
        <h2>回复 ({{ replies|length }})</h2>
        
        {% for reply in replies %}
        <div class="reply">
            <div class="reply-user">
                {% if reply.user.badge %}
                <span class="user-badge" style="background-color:{{ reply.user.color }}">{{ reply.user.badge }}</span>
                {% endif %}
                <span class="user-name" style="color:{{ reply.user.color }}">{{ reply.user.nickname or reply.user.username }}</span>
                <span class="reply-time">{{ reply.timestamp.strftime('%Y-%m-%d %H:%M') }}</span>
            </div>
            <div class="reply-content" data-content="{{ reply.content|safe }}">
                <!-- 内容将由JS渲染 -->
            </div>
        </div>
        {% endfor %}
    </div>
    
    <form id="reply-form" data-thread-id="{{ thread.id }}">
        <textarea name="content" placeholder="输入回复内容...（支持Markdown和LaTeX）"></textarea>
        <button type="submit">回复</button>
    </form>
{% endblock %}

{% block scripts %}
    {{ super() }}
    <script src="{{ url_for('static', filename='js/forum.js') }}"></script>
{% endblock %}